{
  "name": "AI Running Coach - Training Logger",
  "meta": {
    "instanceId": "ai-running-coach-training-log"
  },
  "nodes": [
    {
      "id": "workflow-trigger",
      "name": "When Called by Main Workflow",
      "type": "n8n-nodes-base.executeWorkflowTrigger",
      "position": [0, 300],
      "parameters": {
        "workflowInputs": {
          "values": [
            {
              "name": "user_id",
              "type": "string"
            },
            {
              "name": "user_message",
              "type": "string"
            },
            {
              "name": "chat_id",
              "type": "number"
            },
            {
              "name": "current_plan_id",
              "type": "string"
            }
          ]
        }
      },
      "typeVersion": 1.1
    },
    {
      "id": "extract-training-data",
      "name": "AI Extract Training Data",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "position": [280, 300],
      "parameters": {
        "promptType": "define",
        "text": "–ò–∑–≤–ª–µ–∫–∏ –¥–∞–Ω–Ω—ã–µ –æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–µ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è: \"{{ $json.user_message }}\"\n\n–í–µ—Ä–Ω–∏ –¢–û–õ–¨–ö–û JSON.",
        "hasOutputParser": false,
        "options": {
          "systemMessage": "–¢—ã ‚Äî —Å–∏—Å—Ç–µ–º–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞—Ö.\n\n–ò–∑–≤–ª–µ–∫–∏ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –≤–µ—Ä–Ω–∏ JSON:\n\n{\n  \"is_training_report\": true/false,\n  \"has_enough_data\": true/false,\n  \"data\": {\n    \"distance_km\": —á–∏—Å–ª–æ –∏–ª–∏ null,\n    \"duration_seconds\": —á–∏—Å–ª–æ –∏–ª–∏ null,\n    \"pace_seconds\": —á–∏—Å–ª–æ –∏–ª–∏ null (—Ä–∞—Å—Å—á–∏—Ç–∞–π –µ—Å–ª–∏ –µ—Å—Ç—å –¥–∏—Å—Ç–∞–Ω—Ü–∏—è –∏ –≤—Ä–µ–º—è),\n    \"type\": \"easy_run\"/\"long_run\"/\"tempo\"/\"intervals\"/\"recovery\"/\"race\"/\"other\",\n    \"feeling\": \"great\"/\"good\"/\"ok\"/\"tired\"/\"exhausted\" –∏–ª–∏ null,\n    \"rpe\": 1-10 –∏–ª–∏ null,\n    \"heart_rate\": —á–∏—Å–ª–æ –∏–ª–∏ null,\n    \"notes\": —Å—Ç—Ä–æ–∫–∞ –∏–ª–∏ null\n  },\n  \"missing_fields\": [\"—Å–ø–∏—Å–æ–∫ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –ø–æ–ª–µ–π\"],\n  \"clarification_needed\": \"–≤–æ–ø—Ä–æ—Å –¥–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è\" –∏–ª–∏ null\n}\n\n–ü–†–ê–í–ò–õ–ê –†–ê–°–ü–û–ó–ù–ê–í–ê–ù–ò–Ø:\n\n1. –î–∏—Å—Ç–∞–Ω—Ü–∏—è:\n   - \"5 –∫–º\", \"5–ö\", \"5k\", \"–ø—è—Ç—å –∫–∏–ª–æ–º–µ—Ç—Ä–æ–≤\" = 5\n   - \"–ø—è—Ç–µ—Ä–∫–∞\" = 5, \"–¥–µ—Å—è—Ç–∫–∞\" = 10\n   - \"–ø–æ–ª—É–º–∞—Ä–∞—Ñ–æ–Ω\" = 21.1, \"–º–∞—Ä–∞—Ñ–æ–Ω\" = 42.2\n\n2. –í—Ä–µ–º—è:\n   - \"30 –º–∏–Ω—É—Ç\", \"30–º–∏–Ω\" = 1800 —Å–µ–∫—É–Ω–¥\n   - \"1:30\" (–µ—Å–ª–∏ < 10 = —á–∞—Å—ã:–º–∏–Ω—É—Ç—ã) = 5400 —Å–µ–∫—É–Ω–¥\n   - \"1 —á–∞—Å 30 –º–∏–Ω—É—Ç\" = 5400 —Å–µ–∫—É–Ω–¥\n\n3. –¢–µ–º–ø:\n   - \"—Ç–µ–º–ø 6:00\" = 360 —Å–µ–∫—É–Ω–¥/–∫–º\n   - –†–∞—Å—Å—á–∏—Ç–∞–π: duration_seconds / distance_km\n\n4. –¢–∏–ø —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏:\n   - –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: \"easy_run\"\n   - >10–∫–º –∏–ª–∏ \"–¥–ª–∏—Ç–µ–ª—å–Ω–∞—è\": \"long_run\"\n   - \"–∏–Ω—Ç–µ—Ä–≤–∞–ª—ã\", \"—É—Å–∫–æ—Ä–µ–Ω–∏—è\": \"intervals\"\n   - \"—Ç–µ–º–ø–æ–≤—ã–π\", \"–ø–æ—Ä–æ–≥\": \"tempo\"\n\n5. –°–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ:\n   - \"–æ—Ç–ª–∏—á–Ω–æ\", \"—Å—É–ø–µ—Ä\": \"great\"\n   - \"—Ö–æ—Ä–æ—à–æ\", \"–Ω–æ—Ä–º\": \"good\"\n   - \"—Ç–∞–∫ —Å–µ–±–µ\": \"ok\"\n   - \"—É—Å—Ç–∞–ª\", \"—Ç—è–∂–µ–ª–æ\": \"tired\"\n   - \"—É–±–∏—Ç\", \"–≤—ã–∂–∞—Ç\": \"exhausted\"\n\n–ï—Å–ª–∏ –Ω–µ—Ç –¥–∏—Å—Ç–∞–Ω—Ü–∏–∏ –ò–õ–ò –≤—Ä–µ–º–µ–Ω–∏, has_enough_data = false.\n–í–µ—Ä–Ω–∏ –¢–û–õ–¨–ö–û JSON, –Ω–∏–∫–∞–∫–æ–≥–æ —Ç–µ–∫—Å—Ç–∞.",
          "maxIterations": 2
        }
      },
      "typeVersion": 1.7
    },
    {
      "id": "openai-model-extract",
      "name": "OpenAI Model (Extract)",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "position": [200, 520],
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4o-mini",
          "cachedResultName": "gpt-4o-mini"
        },
        "options": {
          "temperature": 0.2,
          "responseFormat": "json_object"
        }
      },
      "typeVersion": 1.2,
      "credentials": {
        "openAiApi": {
          "id": "OPENAI_CREDENTIALS_ID",
          "name": "OpenAI"
        }
      }
    },
    {
      "id": "parse-extraction",
      "name": "Parse Extraction Result",
      "type": "n8n-nodes-base.code",
      "position": [500, 300],
      "parameters": {
        "jsCode": "let output = $input.item.json.output || $input.item.json.text || '';\nlet extractedData;\n\ntry {\n  if (typeof output === 'object') {\n    extractedData = output;\n  } else {\n    const jsonMatch = output.match(/\\{[\\s\\S]*\\}/);\n    if (jsonMatch) {\n      extractedData = JSON.parse(jsonMatch[0]);\n    } else {\n      throw new Error('No JSON found');\n    }\n  }\n} catch (e) {\n  extractedData = {\n    is_training_report: false,\n    has_enough_data: false,\n    data: null,\n    error: e.message\n  };\n}\n\n// Get input data\nconst inputData = $('When Called by Main Workflow').item.json;\n\n// Calculate pace if we have distance and duration\nif (extractedData.data && extractedData.data.distance_km && extractedData.data.duration_seconds) {\n  if (!extractedData.data.pace_seconds) {\n    extractedData.data.pace_seconds = Math.round(\n      extractedData.data.duration_seconds / extractedData.data.distance_km\n    );\n  }\n}\n\nreturn {\n  json: {\n    ...extractedData,\n    user_id: inputData.user_id,\n    chat_id: inputData.chat_id,\n    current_plan_id: inputData.current_plan_id,\n    user_message: inputData.user_message\n  }\n};"
      },
      "typeVersion": 2
    },
    {
      "id": "check-enough-data",
      "name": "Has Enough Data?",
      "type": "n8n-nodes-base.if",
      "position": [720, 300],
      "parameters": {
        "conditions": {
          "options": {
            "version": 2,
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "combinator": "and",
          "conditions": [
            {
              "id": "is-training",
              "operator": {
                "type": "boolean",
                "operation": "true"
              },
              "leftValue": "={{ $json.is_training_report }}",
              "rightValue": ""
            },
            {
              "id": "has-data",
              "operator": {
                "type": "boolean",
                "operation": "true"
              },
              "leftValue": "={{ $json.has_enough_data }}",
              "rightValue": ""
            }
          ]
        },
        "options": {}
      },
      "typeVersion": 2.2
    },
    {
      "id": "save-training",
      "name": "Save Training to DB",
      "type": "n8n-nodes-base.supabase",
      "position": [960, 200],
      "parameters": {
        "operation": "create",
        "tableId": "trainings",
        "fieldsUi": {
          "fieldValues": [
            {
              "fieldId": "user_id",
              "fieldValue": "={{ $json.user_id }}"
            },
            {
              "fieldId": "weekly_plan_id",
              "fieldValue": "={{ $json.current_plan_id || null }}"
            },
            {
              "fieldId": "date",
              "fieldValue": "={{ $now.format('yyyy-MM-dd') }}"
            },
            {
              "fieldId": "day_of_week",
              "fieldValue": "={{ $now.format('EEEE').toLowerCase() }}"
            },
            {
              "fieldId": "type",
              "fieldValue": "={{ $json.data.type || 'easy_run' }}"
            },
            {
              "fieldId": "distance_km",
              "fieldValue": "={{ $json.data.distance_km }}"
            },
            {
              "fieldId": "duration_seconds",
              "fieldValue": "={{ $json.data.duration_seconds }}"
            },
            {
              "fieldId": "avg_pace_seconds",
              "fieldValue": "={{ $json.data.pace_seconds }}"
            },
            {
              "fieldId": "feeling",
              "fieldValue": "={{ $json.data.feeling }}"
            },
            {
              "fieldId": "rpe",
              "fieldValue": "={{ $json.data.rpe }}"
            },
            {
              "fieldId": "notes",
              "fieldValue": "={{ $json.data.notes }}"
            },
            {
              "fieldId": "source",
              "fieldValue": "manual"
            }
          ]
        }
      },
      "typeVersion": 1,
      "credentials": {
        "supabaseApi": {
          "id": "SUPABASE_CREDENTIALS_ID",
          "name": "Supabase"
        }
      }
    },
    {
      "id": "update-plan-if-exists",
      "name": "Update Plan Status",
      "type": "n8n-nodes-base.if",
      "position": [1180, 200],
      "parameters": {
        "conditions": {
          "options": {
            "version": 2,
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "combinator": "and",
          "conditions": [
            {
              "id": "has-plan",
              "operator": {
                "type": "string",
                "operation": "notEmpty"
              },
              "leftValue": "={{ $('Parse Extraction Result').item.json.current_plan_id }}",
              "rightValue": ""
            }
          ]
        },
        "options": {}
      },
      "typeVersion": 2.2
    },
    {
      "id": "get-plan-data",
      "name": "Get Plan Data",
      "type": "n8n-nodes-base.supabase",
      "position": [1400, 100],
      "parameters": {
        "operation": "get",
        "tableId": "weekly_plans",
        "id": "={{ $('Parse Extraction Result').item.json.current_plan_id }}"
      },
      "typeVersion": 1,
      "credentials": {
        "supabaseApi": {
          "id": "SUPABASE_CREDENTIALS_ID",
          "name": "Supabase"
        }
      }
    },
    {
      "id": "mark-day-completed",
      "name": "Mark Day Completed",
      "type": "n8n-nodes-base.code",
      "position": [1620, 100],
      "parameters": {
        "jsCode": "// Get current plan data\nconst planData = $input.item.json.plan_data;\nconst today = $now.format('EEEE').toLowerCase();\n\n// Mark today's workout as completed\nif (planData[today]) {\n  planData[today].completed = true;\n  planData[today].completed_at = $now.toISO();\n}\n\n// Count completed sessions\nconst days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'];\nlet completedSessions = 0;\ndays.forEach(day => {\n  if (planData[day] && planData[day].completed && planData[day].type !== 'rest') {\n    completedSessions++;\n  }\n});\n\nreturn {\n  json: {\n    id: $input.item.json.id,\n    plan_data: planData,\n    completed_sessions: completedSessions\n  }\n};"
      },
      "typeVersion": 2
    },
    {
      "id": "update-plan-db",
      "name": "Update Plan in DB",
      "type": "n8n-nodes-base.supabase",
      "position": [1840, 100],
      "parameters": {
        "operation": "update",
        "tableId": "weekly_plans",
        "id": "={{ $json.id }}",
        "fieldsUi": {
          "fieldValues": [
            {
              "fieldId": "plan_data",
              "fieldValue": "={{ JSON.stringify($json.plan_data) }}"
            },
            {
              "fieldId": "completed_sessions",
              "fieldValue": "={{ $json.completed_sessions }}"
            }
          ]
        }
      },
      "typeVersion": 1,
      "credentials": {
        "supabaseApi": {
          "id": "SUPABASE_CREDENTIALS_ID",
          "name": "Supabase"
        }
      }
    },
    {
      "id": "generate-feedback",
      "name": "AI Generate Feedback",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "position": [2060, 200],
      "parameters": {
        "promptType": "define",
        "text": "–î–∞–π –∫—Ä–∞—Ç–∫—É—é –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É",
        "hasOutputParser": false,
        "options": {
          "systemMessage": "–¢—ã ‚Äî AI-—Ç—Ä–µ–Ω–µ—Ä –ø–æ –±–µ–≥—É. –î–∞–π –∫—Ä–∞—Ç–∫—É—é –ø–æ–∑–∏—Ç–∏–≤–Ω—É—é –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—É—é —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É.\n\n–î–ê–ù–ù–´–ï –¢–†–ï–ù–ò–†–û–í–ö–ò:\n- –î–∏—Å—Ç–∞–Ω—Ü–∏—è: {{ $('Parse Extraction Result').item.json.data.distance_km }} –∫–º\n- –í—Ä–µ–º—è: {{ Math.floor($('Parse Extraction Result').item.json.data.duration_seconds / 60) }} –º–∏–Ω—É—Ç\n- –¢–µ–º–ø: {{ Math.floor($('Parse Extraction Result').item.json.data.pace_seconds / 60) }}:{{ String($('Parse Extraction Result').item.json.data.pace_seconds % 60).padStart(2, '0') }}/–∫–º\n- –°–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ: {{ $('Parse Extraction Result').item.json.data.feeling || '–Ω–µ —É–∫–∞–∑–∞–Ω–æ' }}\n- RPE: {{ $('Parse Extraction Result').item.json.data.rpe || '–Ω–µ —É–∫–∞–∑–∞–Ω' }}\n\n–ü–†–ê–í–ò–õ–ê:\n1. –ë—É–¥—å –∫—Ä–∞—Ç–∫–∏–º (2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)\n2. –ü–æ—Ö–≤–∞–ª–∏ –∑–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É\n3. –ï—Å–ª–∏ –µ—Å—Ç—å feeling/RPE, –ø—Ä–æ–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π\n4. –ò—Å–ø–æ–ª—å–∑—É–π 1-2 —ç–º–æ–¥–∑–∏\n5. –°–ø—Ä–æ—Å–∏ –æ —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏–∏ –¢–û–õ–¨–ö–û –µ—Å–ª–∏ feeling –Ω–µ —É–∫–∞–∑–∞–Ω\n\n–ü—Ä–∏–º–µ—Ä —Ö–æ—Ä–æ—à–µ–≥–æ –æ—Ç–≤–µ—Ç–∞:\n\"–ó–∞–ø–∏—Å–∞–ª! 5 –∫–º –∑–∞ 30 –º–∏–Ω—É—Ç ‚Äî —Ç–µ–º–ø 6:00/–∫–º. –û—Ç–ª–∏—á–Ω–∞—è –ª–µ–≥–∫–∞—è –ø—Ä–æ–±–µ–∂–∫–∞! üí™ –ö–∞–∫ –æ—â—É—â–µ–Ω–∏—è –ø–æ —à–∫–∞–ª–µ 1-10?\"\n\n–û—Ç–≤–µ—Ç—å –¢–û–õ–¨–ö–û —Ç–µ–∫—Å—Ç–æ–º –¥–ª—è Telegram, –±–µ–∑ JSON.",
          "maxIterations": 2
        }
      },
      "typeVersion": 1.7
    },
    {
      "id": "openai-model-feedback",
      "name": "OpenAI Model (Feedback)",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "position": [1980, 420],
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4o-mini",
          "cachedResultName": "gpt-4o-mini"
        },
        "options": {
          "temperature": 0.8
        }
      },
      "typeVersion": 1.2,
      "credentials": {
        "openAiApi": {
          "id": "OPENAI_CREDENTIALS_ID",
          "name": "OpenAI"
        }
      }
    },
    {
      "id": "ask-for-clarification",
      "name": "Ask for Clarification",
      "type": "n8n-nodes-base.set",
      "position": [960, 400],
      "parameters": {
        "mode": "manual",
        "duplicateItem": false,
        "assignments": {
          "assignments": [
            {
              "id": "output",
              "name": "output",
              "type": "string",
              "value": "={{ $json.clarification_needed || '–ù–µ –ø–æ–Ω—è–ª –¥–∞–Ω–Ω—ã–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏. –ù–∞–ø–∏—à–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ: \"–ü—Ä–æ–±–µ–∂–∞–ª X –∫–º –∑–∞ Y –º–∏–Ω—É—Ç\"' }}"
            },
            {
              "id": "chat_id",
              "name": "chat_id",
              "type": "number",
              "value": "={{ $json.chat_id }}"
            }
          ]
        },
        "options": {}
      },
      "typeVersion": 3.4
    },
    {
      "id": "merge-skip-plan",
      "name": "Merge (Skip Plan)",
      "type": "n8n-nodes-base.merge",
      "position": [1400, 300],
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "typeVersion": 3
    },
    {
      "id": "format-output",
      "name": "Format Output",
      "type": "n8n-nodes-base.set",
      "position": [2280, 200],
      "parameters": {
        "mode": "manual",
        "duplicateItem": false,
        "assignments": {
          "assignments": [
            {
              "id": "output",
              "name": "output",
              "type": "string",
              "value": "={{ $json.output || $json.text || '–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –∑–∞–ø–∏—Å–∞–Ω–∞! üí™' }}"
            },
            {
              "id": "chat_id",
              "name": "chat_id",
              "type": "number",
              "value": "={{ $('Parse Extraction Result').item.json.chat_id }}"
            }
          ]
        },
        "options": {}
      },
      "typeVersion": 3.4
    },
    {
      "id": "merge-output",
      "name": "Merge Output",
      "type": "n8n-nodes-base.merge",
      "position": [2500, 300],
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "typeVersion": 3
    },
    {
      "id": "sticky-note-1",
      "name": "Sticky Note - Info",
      "type": "n8n-nodes-base.stickyNote",
      "position": [-200, 150],
      "parameters": {
        "color": 4,
        "width": 350,
        "height": 200,
        "content": "## AI Running Coach - Training Logger\n\n**–≠—Ç–æ—Ç sub-workflow:**\n1. –ò–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è\n2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–ª–Ω–æ—Ç—É –¥–∞–Ω–Ω—ã—Ö\n3. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É –≤ –ë–î\n4. –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –ø–ª–∞–Ω–∞\n5. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å"
      },
      "typeVersion": 1
    },
    {
      "id": "sticky-note-2",
      "name": "Sticky Note - Patterns",
      "type": "n8n-nodes-base.stickyNote",
      "position": [-200, 400],
      "parameters": {
        "color": 7,
        "width": 350,
        "height": 220,
        "content": "## –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã\n\n- \"–ü—Ä–æ–±–µ–∂–∞–ª 5 –∫–º –∑–∞ 30 –º–∏–Ω—É—Ç\"\n- \"10–ö, —Ç–µ–º–ø 5:30\"\n- \"–õ–µ–≥–∫–∞—è –ø—Ä–æ–±–µ–∂–∫–∞ 3 –∫–º\"\n- \"–ò–Ω—Ç–µ—Ä–≤–∞–ª—ã 8 –∫–º, —É—Å—Ç–∞–ª\"\n- \"–î–ª–∏—Ç–µ–ª—å–Ω–∞—è 15 –∫–º 1:35\"\n- \"–ø—è—Ç–µ—Ä–∫–∞ –∑–∞ –ø–æ–ª—á–∞—Å–∞\""
      },
      "typeVersion": 1
    }
  ],
  "connections": {
    "When Called by Main Workflow": {
      "main": [
        [
          {
            "node": "AI Extract Training Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Model (Extract)": {
      "ai_languageModel": [
        [
          {
            "node": "AI Extract Training Data",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "AI Extract Training Data": {
      "main": [
        [
          {
            "node": "Parse Extraction Result",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parse Extraction Result": {
      "main": [
        [
          {
            "node": "Has Enough Data?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Has Enough Data?": {
      "main": [
        [
          {
            "node": "Save Training to DB",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Ask for Clarification",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Save Training to DB": {
      "main": [
        [
          {
            "node": "Update Plan Status",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update Plan Status": {
      "main": [
        [
          {
            "node": "Get Plan Data",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Merge (Skip Plan)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Plan Data": {
      "main": [
        [
          {
            "node": "Mark Day Completed",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mark Day Completed": {
      "main": [
        [
          {
            "node": "Update Plan in DB",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update Plan in DB": {
      "main": [
        [
          {
            "node": "AI Generate Feedback",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge (Skip Plan)": {
      "main": [
        [
          {
            "node": "AI Generate Feedback",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Model (Feedback)": {
      "ai_languageModel": [
        [
          {
            "node": "AI Generate Feedback",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "AI Generate Feedback": {
      "main": [
        [
          {
            "node": "Format Output",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Format Output": {
      "main": [
        [
          {
            "node": "Merge Output",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ask for Clarification": {
      "main": [
        [
          {
            "node": "Merge Output",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [
    {
      "name": "AI Running Coach"
    },
    {
      "name": "Sub-workflow"
    }
  ],
  "triggerCount": 1,
  "active": false
}
